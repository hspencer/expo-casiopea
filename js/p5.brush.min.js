/*  p5.brush.js v1.0.4c - Alejandro Campos - MIT License */
(function(m,N){"object"===typeof exports&&"undefined"!==typeof module?N(exports):"function"===typeof define&&define.amd?define(["exports"],N):(m=m||self,N(m.brush={}))})(this,function(m){function N(a=!1){Y=!0;l=a?a:window.self;t.load();r.create();Z(l.width/250)}function E(){Y||N()}function aa(a,b,c,d,e=!1){let g=a.x;a=a.y;var k=b.x,p=b.y;b=c.x;c=c.y;var n=d.x,q=d.y;if(g===k&&a===p||b===n&&c===q)return!1;d=k-g;k=p-a;p=n-b;q-=c;n=q*d-p*k;if(0===n)return!1;p=(p*(a-c)-q*(g-b))/n;b=(d*(a-c)-k*(g-b))/n;
return!e&&(0>b||1<b)?!1:{x:g+p*d,y:a+p*k}}function S(a,b,c,d){return(180/Math.PI*Math.atan2(-(d-b),c-a)%360+360)%360}function ba(){u.field.isActive=r.isActive;u.field.current=r.current;u.stroke.isActive=h.isActive;u.stroke.brush=h.name;u.stroke.color=h.c;u.stroke.weight=h.w;u.stroke.clip=h.cr;u.hatch.isActive=y.isActive;u.hatch.hatchingParams=y.hatchingParams;u.hatch.hatchingBrush=y.hatchingBrush;u.fill.isActive=v.isActive;u.fill.color=v.color;u.fill.opacity=v.opacity;u.fill.bleed_strength=v.bleed_strength;
u.fill.texture_strength=v.texture_strength;u.fill.border_strength=v.border_strength;u.others.rotate=x.rotation}function ca(){r.isActive=u.field.isActive;r.current=u.field.current;h.isActive=u.stroke.isActive;h.name=u.stroke.brush;h.c=u.stroke.color;h.w=u.stroke.weight;h.cr=u.stroke.clip;y.isActive=u.hatch.isActive;y.hatchingParams=u.hatch.hatchingParams;y.hatchingBrush=u.hatch.hatchingBrush;v.isActive=u.fill.isActive;v.color=u.fill.color;v.opacity=u.fill.opacity;v.bleed_strength=u.fill.bleed_strength;
v.texture_strength=u.fill.texture_strength;v.border_strength=u.fill.border_strength;x.rotation=u.others.rotate}function O(a,b){E();r.list.set(a,{gen:b});r.current=a;r.refresh()}function Z(a){for(let b of da){let c=h.list.get(b[0]).param;c.weight*=a;c.vibration*=a;c.spacing*=a}ea=a}function fa(a=5,b=45,c={rand:!1,continuous:!1,gradient:!1}){y.isActive=!0;y.hatchingParams=[a,b,c]}function ha(a=0){Q=f.constrain(a,0,1);F=[]}function R(a,b,c){F.push([a,b,c])}function ia(a){a===CLOSE&&(F.push(F[0]),F.push(F[1]));
a=ja(F,Q,a===CLOSE?!0:!1);if(v.isActive||y.isActive)a.fill(),a.hatch();h.isActive&&a.draw();F=!1}function ja(a,b=.5,c=!1){let d=new T(0===b?"segments":"curve");if(a&&0<a.length){let D=0,I,B,L;for(let z=0;z<a.length-1;z++)if(0<b&&z<a.length-2){var e=a[z],g=a[z+1],k=a[z+2],p=dist(e[0],e[1],g[0],g[1]),n=dist(g[0],g[1],k[0],k[1]),q=S(e[0],e[1],g[0],g[1]);k=S(g[0],g[1],k[0],k[1]);let G=b*Math.min(Math.min(p,n),.5*Math.min(p,n));var A=Math.max(p,n),C=p-G,w=n-G;if(Math.floor(q)===Math.floor(k))C=c?0===z?
0:n-L:n,d.addSegment(q,c?0===z?0:p-D:p-D,e[2],!0),z===a.length-3&&d.addSegment(k,C,g[2],!0),D=0,0===z&&(I=p,L=G,B=a[1],D=0);else{p={x:g[0]-G*f.cos(-q),y:g[1]-G*f.sin(-q)};let J={x:p.x+A*f.cos(-q+90),y:p.y+A*f.sin(-q+90)};n={x:g[0]+G*f.cos(-k),y:g[1]+G*f.sin(-k)};A={x:n.x+A*f.cos(-k+90),y:n.y+A*f.sin(-k+90)};A=aa(p,J,n,A,!0);A=dist(p.x,p.y,A.x,A.y);n=dist(p.x,p.y,n.x,n.y)/2;n=180/Math.PI*Math.PI*A*2*Math.asin(n/A)*2/360;w=z===a.length-3?c?I-G:w:0;d.addSegment(q,c?0===z?0:C-D:C-D,e[2],!0);d.addSegment(q,
n,e[2],!0);d.addSegment(k,w,g[2],!0);D=G;0===z&&(I=C,L=G,B=[p.x,p.y])}z==a.length-3&&d.endPlot(k,g[2],!0)}else 0===b&&(0===z&&c&&a.pop(),g=a[z],q=a[z+1],e=dist(g[0],g[1],q[0],q[1]),g=S(g[0],g[1],q[0],q[1]),d.addSegment(g,e,1,!0),z==a.length-2&&d.endPlot(g,1,!0));d.origin=c&&0!==b?B:a[0]}return d}function ka(a,b,c,d){v.opacity=4>arguments.length?3>arguments.length?b:1:d;v.color=3>arguments.length?color(a):color(a,b,c);v.isActive=!0}function la(a,b="out"){v.bleed_strength=f.constrain(a,0,.6);v.direction=
b}function ma(a=.4,b=.4){v.texture_strength=f.constrain(a,0,1);v.border_strength=f.constrain(b,0,1)}let l,Y=!1;p5.prototype.registerMethod("afterSetup",()=>E());const f={source:()=>random(),random(a=0,b=1){return 1===arguments.length?this.map(this.source(),0,1,0,a):this.map(this.source(),0,1,a,b)},randInt(a,b){return Math.floor(this.random(a,b))},weightedRand(a){let b,c,d=[];for(b in a)for(c=0;c<10*a[b];c++)d.push(b);return d[Math.floor(this.source()*d.length)]},map(a,b,c,d,e,g=!1){a=d+(a-b)/(c-b)*
(e-d);return g?d<e?this.constrain(a,d,e):this.constrain(a,e,d):a},constrain(a,b,c){return Math.max(Math.min(a,c),b)},cos(a){return this.c[Math.floor((a%360+360)%360*4)]},sin(a){return this.s[Math.floor((a%360+360)%360*4)]},isPrecalculationDone:!1,preCalculation(){if(!this.isPrecalculationDone){var a=2*Math.PI/1440;this.c=new Float64Array(1440);this.s=new Float64Array(1440);for(let b=0;1440>b;b++){const c=b*a;f.c[b]=Math.cos(c);f.s[b]=Math.sin(c)}this.isPrecalculationDone=!0}},isNumber:a=>!isNaN(a),
toDegrees:a=>(("radians"===angleMode()?180*a/Math.PI:a)%360+360)%360};f.preCalculation();const u={field:{},stroke:{},hatch:{},fill:{},others:{}},x={translation:[0,0],rotation:0,rotate(a=0){x.rotation=f.toDegrees(a)},trans(){return this.translation=[l._renderer.uMVMatrix.mat4[12],l._renderer.uMVMatrix.mat4[13]]}};var W=1;var oa=a=>W*=a;const t={loaded:!1,isBlending:!1,isCaching:!0,currentColor:new Float32Array(3),load(){this.mask=createGraphics(l.width,l.height);this.mask.pixelDensity(l.pixelDensity());
this.mask.clear();this.mask.noSmooth();this.mask.angleMode(DEGREES);m.mask=this.mask;t.loaded||(this.frag=this.frag.replace('#include "spectral.glsl"',this.glsl()));this.shader=l.createShader(this.vert,this.frag);t.loaded=!0;this.noBlend=createGraphics(l.width,l.height);this.noBlend.pixelDensity(l.pixelDensity());this.noBlend.noSmooth();this.noBlend.clear();this.noBlend.angleMode(DEGREES);this.mask2=createGraphics(l.width,l.height,WEBGL);this.mask2.pixelDensity(l.pixelDensity());this.mask2.clear();
this.mask2.angleMode(DEGREES)},getPigment(a){a=a.levels;let b=new Float32Array(3);b[0]=a[0]/255;b[1]=a[1]/255;b[2]=a[2]/255;return b},reDraw(){l.push();l.translate(-x.trans()[0],-x.trans()[1]);l.image(t.noBlend,-l.width/2,-l.height/2);t.noBlend.clear();l.pop()},reBlend(){ba();h.set("marker","white",1);h.line(-10,-10,-5,-5);ca()},color1:new Float32Array(3),color2:new Float32Array(3),blending1:!1,blending2:!1,blend(a=!1,b=!1,c=!1,d=!1){this.isBlending=c?this.blending1:this.blending2;this.currentColor=
c?this.color1:this.color2;if(!this.isBlending)if(a)this.currentColor=this.getPigment(a),c?(this.blending1=!0,this.color1=this.currentColor):(this.blending2=!0,this.color2=this.currentColor);else{l.push();l.translate(-x.trans()[0],-x.trans()[1]);l.image(this.noBlend,-l.width/2,-l.height/2);this.noBlend.clear();l.pop();return}if((a?this.getPigment(a):this.currentColor).toString()!==this.currentColor.toString()||b||!this.isCaching)l.push(),l.translate(-x.trans()[0],-x.trans()[1]),l.image(this.noBlend,
-l.width/2,-l.height/2),this.noBlend.clear(),l.shader(this.shader),this.shader.setUniform("addColor",this.currentColor),this.shader.setUniform("source",l._renderer),this.shader.setUniform("active",d),this.shader.setUniform("random",[f.random(),f.random(),f.random()]),d=c?this.mask2:this.mask,this.shader.setUniform("mask",d),l.fill(0,0,0,0),l.noStroke(),l.rect(-l.width/2,-l.height/2,l.width,l.height),l.pop(),d.clear(),b||(this.currentColor=this.getPigment(a),c?this.color1=this.currentColor:this.color2=
this.currentColor);b&&(this.isBlending=!1,c?this.blending1=this.isBlending:this.blending2=this.isBlending)},vert:"precision highp float;attribute vec3 aPosition;attribute vec2 aTexCoord;uniform mat4 uModelViewMatrix,uProjectionMatrix;varying vec2 vVertTexCoord;void main(){gl_Position=uProjectionMatrix*uModelViewMatrix*vec4(aPosition,1);vVertTexCoord=aTexCoord;}",frag:'precision highp float;varying vec2 vVertTexCoord;uniform sampler2D source,mask;uniform vec4 addColor;uniform vec3 random;uniform bool active;\n        #include "spectral.glsl"\n        float v(vec2 v,vec2 x,float y,out vec2 i){vec2 a=vec2(v.x+v.y*.5,v.y),m=floor(a),d=fract(a);float z=step(d.y,d.x);vec2 r=vec2(z,1.-z),f=m+r,e=m+1.,s=vec2(m.x-m.y*.5,m.y),k=vec2(s.x+r.x-r.y*.5,s.y+r.y),l=vec2(s.x+.5,s.y+1.),g=v-s,o=v-k,t=v-l;vec3 u,c,C,D;if(any(greaterThan(x,vec2(0)))){C=vec3(s.x,k.x,l);D=vec3(s.y,k.y,l.y);if(x.x>0.)C=mod(vec3(s.x,k.x,l),x.x);if(x.y>0.)D=mod(vec3(s.y,k.y,l.y),x.y);u=floor(C+.5*D+.5);c=floor(D+.5);}else u=vec3(m.x,f.x,e),c=vec3(m.y,f.y,e.y);vec3 b=mod(u,289.);b=mod((b*51.+2.)*b+c,289.);b=mod((b*34.+10.)*b,289.);vec3 h=b*.07482+y,E=cos(h),w=sin(h);vec2 A=vec2(E.x,w),B=vec2(E.y,w.y),F=vec2(E.z,w.z);vec3 G=.8-vec3(dot(g,g),dot(o,o),dot(t,t));G=max(G,0.);vec3 H=G*G,I=H*H,J=vec3(dot(A,g),dot(B,o),dot(F,t)),K=H*G,L=-8.*K*J;i=10.9*(I.x*A+L.x*g+(I.y*B+L.y*o)+(I.z*F+L.z*t));return 10.9*dot(I,J);}vec4 v(vec3 v,float f){return vec4(mix(v,vec3(dot(vec3(.299,.587,.114),v)),f),1);}float f(vec2 v,float x,float y,float f){return fract(sin(dot(v,vec2(x,y)))*f);}void main(){vec4 s=texture2D(mask,vVertTexCoord);if(s.x>0.){vec2 m=vec2(12.9898,78.233),k=vec2(7.9898,58.233),d=vec2(17.9898,3.233);float x=f(vVertTexCoord,m.x,m.y,43358.5453)*2.-1.,y=f(vVertTexCoord,k.x,k.y,43213.5453)*2.-1.,l=f(vVertTexCoord,d.x,d.y,33358.5453)*2.-1.;const vec2 z=vec2(0);vec2 o;vec4 b;if(active){float a=v(vVertTexCoord*5.,z,10.*random.x,o),c=v(vVertTexCoord*5.,z,10.*random.y,o),t=v(vVertTexCoord*5.,z,10.*random.z,o),w=.25+.25*v(vVertTexCoord*4.,z,3.*random.x,o);b=vec4(v(addColor.xyz,w).xyz+vec3(a,c,t)*.03,1);}else b=vec4(addColor.xyz,1);if(s.w>.7){float r=.5*(s.w-.7);b=b*(1.-r)-vec4(.5)*r;}vec3 a=spectral_mix(texture2D(source,vVertTexCoord).xyz,b.xyz,.9*s.w);gl_FragColor=vec4(a+.01*vec3(x,y,l),1);}}',
glsl(){return"float spectral_uncompand(float s){return s<.04045?s/12.92:pow((s+.055)/1.055,2.4);}float spectral_compand(float s){return s<.0031308?s*12.92:1.055*pow(s,1./2.4)-.055;}vec3 spectral_srgb_to_linear(vec3 s){return vec3(spectral_uncompand(s[0]),spectral_uncompand(s[1]),spectral_uncompand(s[2]));}vec3 spectral_linear_to_srgb(vec3 s){return clamp(vec3(spectral_compand(s[0]),spectral_compand(s[1]),spectral_compand(s[2])),0.,1.);}void spectral_upsampling(vec3 e,out float m,out float s,out float f,out float r,out float x,out float v,out float z){m=min(e.x,min(e.y,e.z));e-=m;s=min(e.y,e.z);f=min(e.x,e.z);r=min(e.x,e.y);x=min(max(0.,e.x-e.z),max(0.,e.x-e.y));v=min(max(0.,e.y-e.z),max(0.,e.y-e.x));z=min(max(0.,e.z-e.y),max(0.,e.z-e.x));}void spectral_linear_to_reflectance(vec3 s,inout float f[38]){float e,o,m,x,v,w,z;spectral_upsampling(s,e,o,m,x,v,w,z);f[0]=max(1e-4,e+o*.96853629+m*.51567122+x*.02055257+v*.03147571+w*.49108579+z*.97901834);f[1]=max(1e-4,e+o*.96855103+m*.5401552+x*.02059936+v*.03146636+w*.46944057+z*.97901649);f[2]=max(1e-4,e+o*.96859338+m*.62645502+x*.02062723+v*.03140624+w*.4016578+z*.97901118);f[3]=max(1e-4,e+o*.96877345+m*.75595012+x*.02073387+v*.03119611+w*.2449042+z*.97892146);f[4]=max(1e-4,e+o*.96942204+m*.92826996+x*.02114202+v*.03053888+w*.0682688+z*.97858555);f[5]=max(1e-4,e+o*.97143709+m*.97223624+x*.02233154+v*.02856855+w*.02732883+z*.97743705);f[6]=max(1e-4,e+o*.97541862+m*.98616174+x*.02556857+v*.02459485+w*.013606+z*.97428075);f[7]=max(1e-4,e+o*.98074186+m*.98955255+x*.03330189+v*.0192952+w*.01000187+z*.96663223);f[8]=max(1e-4,e+o*.98580992+m*.98676237+x*.05185294+v*.01423112+w*.01284127+z*.94822893);f[9]=max(1e-4,e+o*.98971194+m*.97312575+x*.10087639+v*.01033111+w*.02636635+z*.89937713);f[10]=max(1e-4,e+o*.99238027+m*.91944277+x*.24000413+v*.00765876+w*.07058713+z*.76070164);f[11]=max(1e-4,e+o*.99409844+m*.32564851+x*.53589066+v*.00593693+w*.70421692+z*.4642044);f[12]=max(1e-4,e+o*.995172+m*.13820628+x*.79874659+v*.00485616+w*.85473994+z*.20123039);f[13]=max(1e-4,e+o*.99576545+m*.05015143+x*.91186529+v*.00426186+w*.95081565+z*.08808402);f[14]=max(1e-4,e+o*.99593552+m*.02912336+x*.95399623+v*.00409039+w*.9717037+z*.04592894);f[15]=max(1e-4,e+o*.99564041+m*.02421691+x*.97137099+v*.00438375+w*.97651888+z*.02860373);f[16]=max(1e-4,e+o*.99464769+m*.02660696+x*.97939505+v*.00537525+w*.97429245+z*.02060067);f[17]=max(1e-4,e+o*.99229579+m*.03407586+x*.98345207+v*.00772962+w*.97012917+z*.01656701);f[18]=max(1e-4,e+o*.98638762+m*.04835936+x*.98553736+v*.0136612+w*.9425863+z*.01451549);f[19]=max(1e-4,e+o*.96829712+m*.0001172+x*.98648905+v*.03181352+w*.99989207+z*.01357964);f[20]=max(1e-4,e+o*.89228016+m*8.554e-5+x*.98674535+v*.10791525+w*.99989891+z*.01331243);f[21]=max(1e-4,e+o*.53740239+m*.85267882+x*.98657555+v*.46249516+w*.13823139+z*.01347661);f[22]=max(1e-4,e+o*.15360445+m*.93188793+x*.98611877+v*.84604333+w*.06968113+z*.01387181);f[23]=max(1e-4,e+o*.05705719+m*.94810268+x*.98559942+v*.94275572+w*.05628787+z*.01435472);f[24]=max(1e-4,e+o*.03126539+m*.94200977+x*.98507063+v*.96860996+w*.06111561+z*.01479836);f[25]=max(1e-4,e+o*.02205445+m*.91478045+x*.98460039+v*.97783966+w*.08987709+z*.0151525);f[26]=max(1e-4,e+o*.01802271+m*.87065445+x*.98425301+v*.98187757+w*.13656016+z*.01540513);f[27]=max(1e-4,e+o*.0161346+m*.78827548+x*.98403909+v*.98377315+w*.22169624+z*.01557233);f[28]=max(1e-4,e+o*.01520947+m*.65738359+x*.98388535+v*.98470202+w*.32176956+z*.0156571);f[29]=max(1e-4,e+o*.01475977+m*.59909403+x*.98376116+v*.98515481+w*.36157329+z*.01571025);f[30]=max(1e-4,e+o*.01454263+m*.56817268+x*.98368246+v*.98537114+w*.4836192+z*.01571916);f[31]=max(1e-4,e+o*.01444459+m*.54031997+x*.98365023+v*.98546685+w*.46488579+z*.01572133);f[32]=max(1e-4,e+o*.01439897+m*.52110241+x*.98361309+v*.98550011+w*.47440306+z*.01572502);f[33]=max(1e-4,e+o*.0143762+m*.51041094+x*.98357259+v*.98551031+w*.4857699+z*.01571717);f[34]=max(1e-4,e+o*.01436343+m*.50526577+x*.98353856+v*.98550741+w*.49267971+z*.01571905);f[35]=max(1e-4,e+o*.01435687+m*.5025508+x*.98351247+v*.98551323+w*.49625685+z*.01571059);f[36]=max(1e-4,e+o*.0143537+m*.50126452+x*.98350101+v*.98551563+w*.49807754+z*.01569728);f[37]=max(1e-4,e+o*.01435408+m*.50083021+x*.98350852+v*.98551547+w*.49889859+z*.0157002);}vec3 spectral_xyz_to_srgb(vec3 e){mat3 f;f[0]=vec3(3.24306333,-1.53837619,-.49893282);f[1]=vec3(-.96896309,1.87542451,.04154303);f[2]=vec3(.05568392,-.20417438,1.05799454);float s=dot(f[0],e),m=dot(f[1],e),z=dot(f[2],e);return spectral_linear_to_srgb(vec3(s,m,z));}vec3 spectral_reflectance_to_xyz(float f[38]){vec3 e=vec3(0);e+=f[0]*vec3(6.469e-5,1.84e-6,.00030502);e+=f[1]*vec3(.00021941,6.21e-6,.00103681);e+=f[2]*vec3(.00112057,3.101e-5,.00531314);e+=f[3]*vec3(.00376661,.00010475,.01795439);e+=f[4]*vec3(.01188055,.00035364,.05707758);e+=f[5]*vec3(.02328644,.00095147,.11365162);e+=f[6]*vec3(.03455942,.00228226,.17335873);e+=f[7]*vec3(.03722379,.00420733,.19620658);e+=f[8]*vec3(.03241838,.0066888,.18608237);e+=f[9]*vec3(.02123321,.0098884,.13995048);e+=f[10]*vec3(.01049099,.01524945,.08917453);e+=f[11]*vec3(.00329584,.02141831,.04789621);e+=f[12]*vec3(.00050704,.03342293,.02814563);e+=f[13]*vec3(.00094867,.05131001,.01613766);e+=f[14]*vec3(.00627372,.07040208,.0077591);e+=f[15]*vec3(.01686462,.08783871,.00429615);e+=f[16]*vec3(.02868965,.09424905,.00200551);e+=f[17]*vec3(.04267481,.09795667,.00086147);e+=f[18]*vec3(.05625475,.09415219,.00036904);e+=f[19]*vec3(.0694704,.08678102,.00019143);e+=f[20]*vec3(.08305315,.07885653,.00014956);e+=f[21]*vec3(.0861261,.0635267,9.231e-5);e+=f[22]*vec3(.09046614,.05374142,6.813e-5);e+=f[23]*vec3(.08500387,.04264606,2.883e-5);e+=f[24]*vec3(.07090667,.03161735,1.577e-5);e+=f[25]*vec3(.05062889,.02088521,3.94e-6);e+=f[26]*vec3(.03547396,.01386011,1.58e-6);e+=f[27]*vec3(.02146821,.00810264,0);e+=f[28]*vec3(.01251646,.0046301,0);e+=f[29]*vec3(.00680458,.00249138,0);e+=f[30]*vec3(.00346457,.0012593,0);e+=f[31]*vec3(.00149761,.00054165,0);e+=f[32]*vec3(.0007697,.00027795,0);e+=f[33]*vec3(.00040737,.00014711,0);e+=f[34]*vec3(.00016901,6.103e-5,0);e+=f[35]*vec3(9.522e-5,3.439e-5,0);e+=f[36]*vec3(4.903e-5,1.771e-5,0);e+=f[37]*vec3(2e-5,7.22e-6,0);return e;}float spectral_linear_to_concentration(float v,float m,float s){float z=m*pow(s,2.);return z/(v*pow(1.-s,2.)+z);}vec3 spectral_mix(vec3 s,vec3 f,float e){vec3 v=spectral_srgb_to_linear(s),m=spectral_srgb_to_linear(f);float z[38],o[38];spectral_linear_to_reflectance(v,z);spectral_linear_to_reflectance(m,o);float x=spectral_reflectance_to_xyz(z)[1],w=spectral_reflectance_to_xyz(o)[1];e=spectral_linear_to_concentration(x,w,e);float r[38];for(int c=0;c<38;c++){float y=(1.-e)*(pow(1.-z[c],2.)/(2.*z[c]))+e*(pow(1.-o[c],2.)/(2.*o[c]));r[c]=1.+y-sqrt(pow(y,2.)+2.*y);}return spectral_xyz_to_srgb(spectral_reflectance_to_xyz(r));}vec4 spectral_mix(vec4 s,vec4 e,float z){return vec4(spectral_mix(s.xyz,e.xyz,z),mix(s.w,e.w,z));}"}};
p5.prototype.registerMethod("afterSetup",()=>t.blend(!1,!0));p5.prototype.registerMethod("afterSetup",()=>t.blend(!1,!0,!0));p5.prototype.registerMethod("post",()=>t.blend(!1,!0));p5.prototype.registerMethod("post",()=>t.blend(!1,!0,!0));const r={isActive:!1,list:new Map,current:"",step_length(){return Math.min(l.width,l.height)/1E3},create(){this.R=.01*l.width;this.left_x=-1*l.width;this.top_y=-1*l.height;this.num_columns=Math.round(2*l.width/this.R);this.num_rows=Math.round(2*l.height/this.R);this.addStandard()},
flow_field(){return this.list.get(this.current).field},refresh(a=0){this.list.get(this.current).field=this.list.get(this.current).gen(a,this.genField())},genField(){let a=Array(this.num_columns);for(let b=0;b<this.num_columns;b++)a[b]=new Float64Array(this.num_rows);return a},addStandard(){O("curved",function(a,b){let c=f.randInt(-25,-15);0==f.randInt(0,100)%2&&(c*=-1);for(let e=0;e<r.num_columns;e++)for(let g=0;g<r.num_rows;g++){var d=noise(.02*e+.03*a,.02*g+.03*a);d=f.map(d,0,1,-c,c);b[e][g]=3*
d}return b});O("truncated",function(a,b){a=f.randInt(-25,-15)+5*f.sin(a);0==f.randInt(0,100)%2&&(a*=-1);let c=f.randInt(5,10);for(let e=0;e<r.num_columns;e++)for(let g=0;g<r.num_rows;g++){var d=noise(.02*e,.02*g);d=Math.round(f.map(d,0,1,-a,a)/c)*c;b[e][g]=4*d}return b});O("zigzag",function(a,b){a=f.randInt(-30,-15)+Math.abs(44*f.sin(a));0==f.randInt(0,100)%2&&(a*=-1);let c=0;for(let d=0;d<r.num_columns;d++){for(let e=0;e<r.num_rows;e++)b[d][e]=c,c+=a,a*=-1;c+=a;a*=-1}return b});O("waves",function(a,
b){let c=f.randInt(10,15)+5*f.sin(a);a=f.randInt(3,6)+3*f.cos(a);let d=f.randInt(20,35);for(let e=0;e<r.num_columns;e++)for(let g=0;g<r.num_rows;g++){let k=f.sin(c*e)*d*f.cos(g*a)+f.randInt(-3,3);b[e][g]=k}return b});O("seabed",function(a,b){let c=f.random(.4,.8),d=f.randInt(18,26);for(let g=0;g<r.num_columns;g++)for(let k=0;k<r.num_rows;k++){var e=f.randInt(15,20);e=d*f.sin(c*k*g+e);b[g][k]=1.1*e*f.cos(a)}return b})}};class U{constructor(a,b){this.update(a,b);this.plotted=0}update(a,b){this.x=a;
this.y=b;r.isActive&&(this.x_offset=this.x-r.left_x+x.trans()[0],this.y_offset=this.y-r.top_y+x.trans()[1],this.column_index=Math.round(this.x_offset/r.R),this.row_index=Math.round(this.y_offset/r.R))}reset(){this.plotted=0}isIn(){return r.isActive?0<=this.column_index&&0<=this.row_index&&this.column_index<r.num_columns&&this.row_index<r.num_rows:this.isInCanvas()}isInCanvas(){let a=l.width,b=l.height;return this.x>=-a-x.trans()[0]&&this.x<=a-x.trans()[0]&&this.y>=-b-x.trans()[1]&&this.y<=b-x.trans()[1]}angle(){return this.isIn()&&
r.isActive?r.flow_field()[this.column_index][this.row_index]:0}moveTo(a,b,c=r.step_length(),d=!0){if(this.isIn()){let g;if(!d){g=f.cos(-b);var e=f.sin(-b)}for(let k=0;k<a/c;k++){d&&(e=this.angle(),g=f.cos(e-b),e=f.sin(e-b));let p=c*g,n=c*e;this.plotted+=c;this.update(this.x+p,this.y+n)}}else this.plotted+=c}plotTo(a,b,c,d){if(this.isIn()){d=1/d;for(let g=0;g<b/c;g++){var e=this.angle();let k=a.angle(this.plotted),p=c*f.cos(e-k);e=c*f.sin(e-k);this.plotted+=c*d;this.update(this.x+p,this.y+e)}}else this.plotted+=
c/scale}}let ea=1;const h={isActive:!0,list:new Map,c:"#000000",w:1,cr:null,name:"HB",add:(a,b)=>{const c="marker"===b.type||"custom"===b.type||"image"===b.type;c||"spray"===b.type||(b.type="default");"image"===b.type&&(V.add(b.image.src),b.tip=()=>h.mask.image(V.tips.get(h.p.image.src),-h.p.weight/2,-h.p.weight/2,h.p.weight,h.p.weight));b.blend=c&&!1!==b.blend||b.blend?!0:!1;h.list.set(a,{param:b,colors:[],buffers:[]})},set(a,b,c=1){h.setBrush(a);h.c=b;h.w=c;h.isActive=!0},setBrush(a){h.name=a},
setColor(a,b,c){0<arguments.length&&(h.c=2>arguments.length?a:[a,b,c]);h.isActive=!0},setWeight(a){h.w=a},clip(a){h.cr=a},noClip(){h.cr=null},line(a,b,c,d){E();let e=dist(a,b,c,d);0!=e&&(h.initializeDrawingState(a,b,e,!1,!1),a=S(a,b,c,d),h.draw(a,!1))},flowLine(a,b,c,d){E();h.initializeDrawingState(a,b,c,!0,!1);h.draw(f.toDegrees(d),!1)},flowShape(a,b,c,d){E();h.initializeDrawingState(b,c,a.length,!0,a);h.draw(d,!0)},spacing(){this.p=this.list.get(this.name).param;return"default"===this.p.type||"spray"===
this.p.type?this.p.spacing/this.w:this.p.spacing},initializeDrawingState(a,b,c,d,e){this.position=new U(a,b);this.length=c;this.flow=d;(this.plot=e)&&e.calcIndex(0)},draw(a,b){b||(this.dir=a);this.pushState();const c=this.spacing(),d=b?Math.round(this.length*a/c):Math.round(this.length/c);for(let e=0;e<d;e++)this.tip(),b?this.position.plotTo(this.plot,c,c,a):this.position.moveTo(c,a,c,this.flow);this.popState()},drawTip(a){this.pushState(!0);this.tip(a);this.popState(!0)},pushState(a=!1){this.p=this.list.get(this.name).param;
if(!a){this.a="custom"!==this.p.pressure.type?f.random(-1,1):0;this.b="custom"!==this.p.pressure.type?f.random(1,1.5):0;this.cp="custom"!==this.p.pressure.type?f.random(3,3.5):f.random(-.2,.2);const [b,c]=this.p.pressure.min_max;this.min=b;this.max=c}this.c=l.color(this.c);this.mask=this.p.blend?"image"===this.p.type?t.mask2:t.mask:t.noBlend;x.trans();this.mask.push();this.mask.noStroke();"image"===this.p.type?this.mask.translate(x.translation[0],x.translation[1]):this.mask.translate(x.translation[0]+
l.width/2,x.translation[1]+l.height/2);this.mask.rotate(-x.rotation);this.mask.scale(W);this.p.blend&&("image"!==this.p.type?t.blend(this.c):t.blend(this.c,!1,!0),a||this.markerTip())},popState(a=!1){this.p.blend&&!a&&this.markerTip();this.mask.pop()},tip(a=!1){a=a?a:this.calculatePressure();let b=this.calculateAlpha(a);this.applyColor(b);if(this.isInsideClippingArea())switch(this.p.type){case "spray":this.drawSpray(a);break;case "marker":this.drawMarker(a);break;case "custom":case "image":this.drawCustomOrImage(a,
b);break;default:this.drawDefault(a)}},calculatePressure(){return this.plot?this.simPressure()*this.plot.pressure(this.position.plotted):this.simPressure()},simPressure(){return"custom"===this.p.pressure.type?f.map(this.p.pressure.curve(this.position.plotted/this.length)+this.cp,0,1,this.min,this.max,!0):this.gauss()},gauss(a=.5+h.p.pressure.curve[0]*h.a,b=1-h.p.pressure.curve[1]*h.b,c=h.cp,d=h.min,e=h.max){return f.map(1/(1+Math.pow(Math.abs((this.position.plotted-a*this.length)/(b*this.length/2)),
2*c)),0,1,d,e)},calculateAlpha(a){return Math.floor(("default"!==this.p.type&&"spray"!==this.p.type?this.p.opacity/this.w:this.p.opacity)*Math.pow(a,"marker"===this.p.type?.7:1.5))},applyColor(a){this.p.blend?this.mask.fill(255,0,0,a/2):(this.c.setAlpha(a),this.mask.fill(this.c))},isInsideClippingArea(){if(h.cr)return this.position.x>=h.cr[0]&&this.position.x<=h.cr[2]&&this.position.y>=h.cr[1]&&this.position.y<=h.cr[3];let a=.55*l.width,b=.55*l.height;return this.position.x>=-a-x.trans()[0]&&this.position.x<=
a-x.trans()[0]&&this.position.y>=-b-x.trans()[1]&&this.position.y<=b-x.trans()[1]},drawSpray(a){let b=this.w*this.p.vibration*a+this.w*randomGaussian()*this.p.vibration/3,c=this.p.weight*f.random(.9,1.1);a=this.p.quality/a;for(let d=0;d<a;d++){let e=f.random(.9,1.1),g=e*b*f.random(-1,1),k=f.random(-1,1);this.mask.circle(this.position.x+g,this.position.y+k*Math.sqrt(Math.pow(e*b,2)-Math.pow(g,2)),c)}},drawMarker(a,b=!0){let c=b?this.w*this.p.vibration:0,d=b?c*f.random(-1,1):0;b=b?c*f.random(-1,1):
0;this.mask.circle(this.position.x+d,this.position.y+b,this.w*this.p.weight*a)},drawCustomOrImage(a,b,c=!0){this.mask.push();let d=c?this.w*this.p.vibration:0,e=c?d*f.random(-1,1):0;c=c?d*f.random(-1,1):0;this.mask.translate(this.position.x+e,this.position.y+c);this.adjustSizeAndRotation(this.w*a,b);this.p.tip(this.mask);this.mask.pop()},drawDefault(a){let b=this.w*this.p.vibration*(this.p.definition+(1-this.p.definition)*randomGaussian()*this.gauss(.5,.9,5,.2,1.2)/a);.4<f.random(0,this.p.quality)&&
this.mask.circle(this.position.x+.7*b*f.random(-1,1),this.position.y+b*f.random(-1,1),a*this.p.weight*f.random(.85,1.15))},adjustSizeAndRotation(a,b){this.mask.scale(a);"image"===this.p.type&&(this.p.blend?this.mask.tint(255,0,0,b/2):this.mask.tint(this.mask.red(this.c),this.mask.green(this.c),this.mask.blue(this.c),b));"random"===this.p.rotate?this.mask.rotate(f.randInt(0,360)):"natural"===this.p.rotate&&(a=(this.plot?-this.plot.angle(this.position.plotted):-this.dir)+(this.flow?this.position.angle():
0),this.mask.rotate(a))},markerTip(){if(this.isInsideClippingArea()){let b=this.calculatePressure();var a=this.calculateAlpha(b);this.mask.fill(255,0,0,a/1.5);if("marker"===h.p.type)for(a=1;5>a;a++)this.drawMarker(b*a/5,!1);else if("custom"===h.p.type||"image"===h.p.type)for(let c=1;5>c;c++)this.drawCustomOrImage(b*c/5,a,!1)}}},V={tips:new Map,add(a){this.tips.set(a,!1)},imageToWhite(a){a.loadPixels();for(let b=0;b<4*a.width*a.height;b+=4){let c=(a.pixels[b]+a.pixels[b+1]+a.pixels[b+2])/3;a.pixels[b]=
a.pixels[b+1]=a.pixels[b+2]=255;a.pixels[b+3]=255-c}a.updatePixels()},load(){for(let a of this.tips.keys()){let b=loadImage(a,()=>V.imageToWhite(b));this.tips.set(a,b)}}},y={isActive:!1,hatchingParams:[5,45,{}],hatchingBrush:!1,hatch(a){let b=y.hatchingParams[0],c=y.hatchingParams[1],d=y.hatchingParams[2],e=h.c,g=h.name,k=h.w,p=h.isActive;y.hatchingBrush&&h.set(y.hatchingBrush[0],y.hatchingBrush[1],y.hatchingBrush[2]);c=f.toDegrees(c)%180;let n=Infinity,q=-Infinity,A=Infinity,C=-Infinity;var w=K=>
{for(let H of K.a)n=H[0]<n?H[0]:n,q=H[0]>q?H[0]:q,A=H[1]<A?H[1]:A,C=H[1]>C?H[1]:C};Array.isArray(a)||(a=[a]);for(var D of a)w(D);D=new P([[n,A],[q,A],[q,C],[n,C]]);let I=90>=c&&0<=c?A:C;var B=d.gradient?map(d.gradient,0,1,1,1.1,!0):1;w=[];let L=0,z=b,G=K=>({point1:{x:n+z*K*f.cos(-c+90),y:I+z*K*f.sin(-c+90)},point2:{x:n+z*K*f.cos(-c+90)+f.cos(-c),y:I+z*K*f.sin(-c+90)+f.sin(-c)}});for(;0<D.intersect(G(L)).length;){let K=[];for(var J of a)K.push(J.intersect(G(L)));w[L]=K.flat().sort((H,X)=>H.x===X.x?
H.y-X.y:H.x-X.x);z*=B;L++}a=[];for(var M of w)"undefined"!==typeof M[0]&&a.push(M);M=d.rand?d.rand:0;for(J=0;J<a.length;J++)for(w=a[J],D=0<J&&d.continuous,B=0;B<w.length-1;B+=2)0!==M&&(w[B].x+=M*b*f.random(-10,10),w[B].y+=M*b*f.random(-10,10),w[B+1].x+=M*b*f.random(-10,10),w[B+1].y+=M*b*f.random(-10,10)),h.line(w[B].x,w[B].y,w[B+1].x,w[B+1].y),D&&h.line(a[J-1][1].x,a[J-1][1].y,w[B].x,w[B].y);h.set(g,e,k);h.isActive=p}};class P{constructor(a,b=!1){this.a=a;this.vertices=a.map(c=>({x:c[0],y:c[1]}));
b&&(this.vertices=a);this.sides=this.vertices.map((c,d,e)=>[c,e[(d+1)%e.length]])}intersect(a){let b=`${a.point1.x},${a.point1.y}-${a.point2.x},${a.point2.y}`;if(this._intersectionCache&&this._intersectionCache[b])return this._intersectionCache[b];let c=[];for(let d of this.sides){let e=aa(a.point1,a.point2,d[0],d[1]);!1!==e&&c.push(e)}this._intersectionCache||(this._intersectionCache={});return this._intersectionCache[b]=c}draw(a=!1,b,c){let d=h.isActive;a&&h.set(a,b,c);if(h.isActive){E();for(let e of this.sides)h.line(e[0].x,
e[0].y,e[1].x,e[1].y)}h.isActive=d}fill(a=!1,b,c,d,e,g){let k=v.isActive;a&&(ka(a,b),la(c,g),ma(d,e));v.isActive&&(E(),v.fill(this));v.isActive=k}hatch(a=!1,b,c){let d=y.isActive;a&&fa(a,b,c);y.isActive&&(E(),y.hatch(this));y.isActive=d}}class T{constructor(a){this.segments=[];this.angles=[];this.pres=[];this.type=a;this.dir=0;this.calcIndex(0);this.pol=!1}addSegment(a=0,b=0,c=1,d=!1){0<this.angles.length&&this.angles.splice(-1);a=d?(a%360+360)%360:f.toDegrees(a);this.angles.push(a);this.pres.push(c);
this.segments.push(b);this.length=this.segments.reduce((e,g)=>e+g,0);this.angles.push(a)}endPlot(a=0,b=1,c=!1){a=c?(a%360+360)%360:f.toDegrees(a);this.angles.splice(-1);this.angles.push(a);this.pres.push(b)}rotate(a){this.dir=f.toDegrees(a)}pressure(a){return a>this.length?this.pres[this.pres.length-1]:this.curving(this.pres,a)}angle(a){if(a>this.length)return this.angles[this.angles.length-1];this.calcIndex(a);return"curve"===this.type?this.curving(this.angles,a)+this.dir:this.angles[this.index]+
this.dir}curving(a,b){let c=a[this.index];a=a[this.index+1];"undefined"==typeof a&&(a=c);180<Math.abs(a-c)&&(a>c?a=-(360-a):c=-(360-c));return f.map(b-this.suma,0,this.segments[this.index],c,a,!0)}calcIndex(a){this.index=-1;let b=this.suma=0;for(;b<=a;)this.suma=b,b+=this.segments[this.index+1],this.index++}genPol(a,b,c=1,d=!1){E();var e=0;let g=9999;for(var k of this.segments)k*=c,0!==k&&(e=Math.max(e,k),g=Math.min(g,k));c=h.spacing();k=[];let p=f.constrain(v.bleed_strength,.05,1);d=(e+g)*(d?.03:
v.isAnimated?.25:p);this.calcIndex(0);a=new U(a,b);b=Math.round(this.length/c);for(e=0;e<b;e++)a.x&&(k[Math.floor(a.plotted/d)]=[a.x,a.y]),a.plotTo(this,c,c,1);this.calcIndex(0);return new P(k)}draw(a,b,c){h.isActive&&(E(),this.origin&&(a=this.origin[0],b=this.origin[1],c=1),h.flowShape(this,a,b,c))}fill(a,b,c){v.isActive&&(E(),this.origin&&(a=this.origin[0],b=this.origin[1],c=1),this.pol||(this.pol=this.genPol(a,b,c)),this.pol.fill())}hatch(a,b,c){y.isActive&&(E(),this.origin&&(a=this.origin[0],
b=this.origin[1],c=1),this.pol||(this.pol=this.genPol(a,b,c,!0)),this.pol.hatch())}}let F=!1,Q;const v={isActive:!1,isAnimated:!1,color:"#002185",opacity:80,bleed_strength:.07,texture_strength:.4,border_strength:.4,fill(a){this.polygon=a;this.v=a.a.map(c=>createVector(c[0],c[1]));const b=this.v.length*f.random(.4);v.m=this.v.map((c,d)=>{c=f.random(.8,1.2)*this.bleed_strength;return d<b?constrain(2*c,0,.9):c});a=f.randInt(0,this.v.length);this.v=[...this.v.slice(a),...this.v.slice(0,a)];(new na(this.v,
this.m,this.calcCenter(),[],!0)).fill(this.color,int(map(this.opacity,0,155,0,20,!0)),this.texture_strength)},calcCenter(){let a=0,b=0;for(let c=0;c<this.v.length;++c)a+=this.v[c].x,b+=this.v[c].y;a/=this.v.length;b/=this.v.length;return createVector(a,b)}};class na{constructor(a,b,c,d,e=!1){this.pol=new P(a,!0);this.v=a;this.dir=d;this.m=b;this.midP=c;this.size=p5.Vector.sub(this.midP,this.v[0]).mag();if(e)for(a="radians"===angleMode()?Math.PI/180:1,b=0;b<this.v.length;b++){c=this.v[b];d=this.v[(b+
1)%this.v.length];e=p5.Vector.sub(d,c);var g=e.copy();g.rotate(90*a);e={point1:{x:c.x+e.x/2,y:c.y+e.y/2},point2:{x:c.x+e.x/2+g.x,y:c.y+e.y/2+g.y}};g=0;for(let k of v.polygon.intersect(e)).01<(d.x-c.x)*(k.y-c.y)-(d.y-c.y)*(k.x-c.x)&&g++;this.dir[b]=0===g%2?!0:!1}}grow(a,b=!1){const c=[],d=[],e=[];let g=.2<=a&&10<=this.v.length?Math.floor(a*this.v.length):this.v.length;const k=C=>{const w=randomGaussian(.5,.1);return C+.1*(w-.5)},p="radians"===angleMode()?Math.PI/180:1;for(let C=0;C<g;C++){var n=this.v[C],
q=this.v[(C+1)%g];let w=.1===a?.1>=v.bleed_strength?.25:.75:this.m[C];b&&(w*=-.5);c.push(n);d.push(k(w));let D=p5.Vector.lerp(n,q,constrain(randomGaussian(.5,.2),.1,.9));n=p5.Vector.sub(q,n);q=n.copy().normalize();let I=this.dir[C];var A="out"==v.direction?90:-90;A=(I?A:-A)+45*randomGaussian(0,.4);q.rotate(A*p);q.mult(randomGaussian(.5,.2)*random(.6,1.4)*n.mag()*w);D.add(q);c.push(D);d.push(k(w));e.push(I,I)}return new na(c,d,this.midP,e)}fill(a,b,c){const d=b/5+c*b/6,e=b/4+c*b/3,g=b/7+c*b/3;b/=5;
c*=3;x.trans();t.blend(a,!1,!1,!0);t.mask.push();t.mask.noStroke();t.mask.translate(x.translation[0]+l.width/2,x.translation[1]+l.height/2);t.mask.rotate(x.rotation);t.mask.scale(W);a=this.grow();let k=a.grow().grow(.9),p=k.grow(.75),n=this.grow(.85);for(let q=0;24>q;q++){if(6===q||12===q||18===q)a=a.grow(),k=k.grow(.75),p=p.grow(.75),n=n.grow(.1,!0);a.grow().layer(q,b);n.grow(.1,!0).grow(.1).layer(q,g,!1);k.grow(.1).grow(.1).layer(q,e,!1);p.grow(.8).grow(.1).layer(q,d,!1);0!==c&&a.erase(c)}t.mask.pop()}layer(a,
b,c=!0){t.mask.fill(255,0,0,b);c?(t.mask.stroke(255,0,0,.5+1.5*v.border_strength),t.mask.strokeWeight(f.map(a,0,24,6,.5))):t.mask.noStroke();t.mask.beginShape();for(let d of this.v)t.mask.vertex(d.x,d.y);t.mask.endShape(CLOSE)}erase(a){const b=f.random(80,110),c=this.size/2,d=.025*this.size,e=.19*this.size;t.mask.erase(3.5*a,0);for(a=0;a<b;a++){const g=this.midP.x+randomGaussian(0,c),k=this.midP.y+randomGaussian(0,c),p=f.random(d,e);t.mask.circle(g,k,p)}t.mask.noErase()}}p5.RendererGL.prototype.erase=
function(a,b){this._isErasing||(this._cachedBlendMode=this.curBlendMode,this._isErasing=!0,this.blendMode("destination-out"),this._cachedFillStyle=this.curFillColor.slice(),this.curFillColor=[1,1,1,a/255],this._cachedStrokeStyle=this.curStrokeColor.slice(),this.curStrokeColor=[1,1,1,b/255])};p5.RendererGL.prototype.noErase=function(){if(this._isErasing){this.curFillColor=this._cachedFillStyle.slice();this.curStrokeColor=this._cachedStrokeStyle.slice();let a=this.curBlendMode;this.blendMode(this._cachedBlendMode);
this._cachedBlendMode=a;this._isErasing=!1;this._applyBlendMode()}};const pa="weight vibration definition quality opacity spacing pressure type tip rotate".split(" "),da=[["pen",[.35,.12,.5,8,200,.3,{curve:[.15,.2],min_max:[1.3,1]}]],["rotring",[.2,.05,1,3,250,.15,{curve:[.05,.2],min_max:[1.2,.95]}]],["2B",[.35,.5,.1,8,180,.2,{curve:[.15,.2],min_max:[1.3,1]}]],["HB",[.3,.5,.4,4,180,.25,{curve:[.15,.2],min_max:[1.2,.9]}]],["2H",[.2,.4,.3,2,150,.2,{curve:[.15,.2],min_max:[1.2,.9]}]],["cpencil",[.4,
.6,.8,7,120,.15,{curve:[.15,.2],min_max:[.95,1.15]}]],["charcoal",[.5,2,.8,300,110,.06,{curve:[.15,.2],min_max:[1.15,.85]}]],["hatch_brush",[.2,.4,.3,2,150,.15,{curve:[.5,.7],min_max:[1,1.5]}]],["spray",[.3,12,15,40,120,.65,{curve:[0,.1],min_max:[.15,1.2]},"spray"]],["marker",[2.5,.12,null,null,30,.4,{curve:[.35,.25],min_max:[1.35,1]},"marker"]],["marker2",[2.5,.12,null,null,25,.35,{curve:[.35,.25],min_max:[1.15,.95]},"custom",function(a){let b=ea;a.rect(-1.5*b,-1.5*b,3*b,3*b);a.rect(1*b,1*b,1*b,
1*b)},"natural"]]];for(let a of da){let b={};for(let c=0;c<a[1].length;c++)b[pa[c]]=a[1][c];h.add(a[0],b)}m.config=function(a={}){a.R&&(f.source=a.R)};m.load=N;m.preload=function(){V.load()};m.colorCache=function(a=!0){t.isCaching=a};m.scaleBrushes=Z;m.push=ba;m.pop=ca;m.reDraw=t.reDraw;m.reBlend=t.reBlend;m.rotate=x.rotate;m.scale=oa;m.addField=O;m.field=function(a){E();r.isActive=!0;r.current=a};m.noField=function(){r.isActive=!1};m.refreshField=function(a){r.refresh(a)};m.listFields=function(){return Array.from(r.list.keys())};
m.add=h.add;m.box=function(){return Array.from(h.list.keys())};m.set=h.set;m.pick=h.setBrush;m.clip=h.clip;m.noClip=h.noClip;m.point=function(a,b,c){E();h.position=new U(a,b);h.drawTip(c)};m.stroke=h.setColor;m.strokeWeight=h.setWeight;m.noStroke=function(){h.isActive=!1};m.fill=ka;m.bleed=la;m.fillTexture=ma;m.noFill=function(){v.isActive=!1};m.fillAnimatedMode=function(a){v.isAnimated=a};m.line=h.line;m.flowLine=h.flowLine;m.plot=h.flowShape;m.rect=function(a,b,c,d,e=CORNER){e==CENTER&&(a-=c/2,
b-=d/2);r.isActive?(ha(0),R(a,b),R(a+c,b),R(a+c,b+d),R(a,b+d),ia(CLOSE)):(a=new P([[a,b],[a+c,b],[a+c,b+d],[a,b+d]]),a.fill(),a.hatch(),a.draw())};m.circle=function(a,b,c,d=!1){let e=new T("curve");var g=Math.PI*c/2;let k=random(0,360);e.addSegment(0+k+(d?f.random(-1,1):0),g+(d?f.random(-1,1):0),1,!0);e.addSegment(-90+k+(d?f.random(-1,1):0),g+(d?f.random(-1,1):0),1,!0);e.addSegment(-180+k+(d?f.random(-1,1):0),g+(d?f.random(-1,1):0),1,!0);e.addSegment(-270+k+(d?f.random(-1,1):0),g+(d?f.random(-1,1):
0),1,!0);g=d?f.randInt(-5,5):0;d&&e.addSegment(0+k,Math.PI/180*g*c,!0);e.endPlot(g+k,1,!0);e.fill(a-c*f.sin(k),b-c*f.cos(-k),1);e.hatch(a-c*f.sin(k),b-c*f.cos(-k),1);e.draw(a-c*f.sin(k),b-c*f.cos(-k),1)};m.polygon=function(a){a=new P(a);a.fill();a.hatch();a.draw()};m.spline=function(a,b=.5){ja(a,b).draw()};m.beginShape=ha;m.vertex=R;m.endShape=ia;m.beginStroke=function(a,b,c){Q=[b,c];F=new T(a)};m.segment=function(a,b,c){F.addSegment(a,b,c)};m.endStroke=function(a,b){F.endPlot(a,b);F.draw(Q[0],Q[1],
1);F=!1};m.hatchArray=y.hatch;m.hatch=fa;m.setHatch=function(a,b="black",c=1){y.hatchingBrush=[a,b,c]};m.noHatch=function(){y.isActive=!1;y.hatchingBrush=!1};m.Polygon=P;m.Plot=T;m.Position=U});